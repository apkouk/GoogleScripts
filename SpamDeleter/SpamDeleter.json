{"files":[{"id":"73af3e1b-7b77-4b6e-aeb1-ddff72a37b30","name":"Code","type":"server_js","source":"function doGet()\n{\n  var messagesDeleted \u003d SpamDeleter();\n  SendSummarySpam(messagesDeleted);\n  return HtmlService.createHtmlOutput(\"\u003cHTML\u003e   \u003cHEAD\u003e      \u003cTITLE\u003eSPAM DELETED ON \" + new Date().toLocaleTimeString() + \"\u003c/TITLE\u003e   \u003c/HEAD\u003e   \u003cBODY\u003e      \u003cP\u003e\" + messagesDeleted +\"  \u003c/BODY\u003e\u003c/HTML\u003e\"); \n}\n\nfunction SpamDeleter() { \n \n  var spamThreats \u003d GmailApp.getSpamThreads();\n  //Logger.log(\"Num: \" + spamThreats.length);\n  var messageString \u003d \u0027\u0027;\n  var message;\n  if(spamThreats.length \u003e 0)\n  {     \n   for(var i \u003d 0; i \u003c spamThreats.length; i++)\n   {     \n     var message \u003d spamThreats[i].getFirstMessageSubject();\n     messageString \u003d messageString + spamThreats[i].getFirstMessageSubject() + \" \u003cbr/\u003e\u003cbr/\u003e\";\n     //Logger.log(\"Message: \" + (message));\n     if(spamThreats[i].isInSpam())\n     {\n       GmailApp.moveThreadToTrash(spamThreats[i]); \n       //Logger.log(\"SENT TO TRASH: \" + (messageString));\n     }     \n   }  \n  }\n  else\n  {\n    return \"Congratulations! No spam found.\"\n  }\n  return messageString;\n}\n\nfunction SendSummarySpam(messagesDeleted){\n  \n  var recipient \u003d Session.getActiveUser().getEmail();\n  var subject \u003d \u0027Spam moved to trash at \u0027 +  new Date().toLocaleTimeString();\n  var body \u003d messagesDeleted;\n     \n  //Logger.log(\"Creating mail\"); \n  Logger.log(recipient);\n  MailApp.sendEmail(recipient, subject, body);\n  //Logger.log(\"Mail sent\"); \n}\n\n\n//Azz que envie un mail con los mensajes enviados a la trash"}]}
